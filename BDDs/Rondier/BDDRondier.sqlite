

CREATE TABLE `aEteEffectueePar` (
  `id_ronde` INTEGER NOT NULL,
  `id_agent` INTEGER NOT NULL,
  `date_heure` TEXT NULL DEFAULT NULL,
  PRIMARY KEY (`id_ronde`, `id_agent`),
  CONSTRAINT `aEteEffectueePar_ibfk_1`
    FOREIGN KEY (`id_agent`)
    REFERENCES `agents` (`id_agent`),
  CONSTRAINT `aEteEffectueePar_ibfk_2`
    FOREIGN KEY (`id_ronde`)
    REFERENCES `rondes` (`id_ronde`));

CREATE TABLE `aEteScannePar` (
  `id_pointeau` INTEGER NOT NULL,
  `id_agent` INTEGER NOT NULL,
  `id_ronde` INTEGER NOT NULL,
  `id_anomalie` INTEGER NOT NULL,
  `ordre` INTEGER NULL DEFAULT NULL,
  `temps` TEXT NULL DEFAULT NULL,
  PRIMARY KEY (`id_pointeau`, `id_agent`, `id_ronde`, `id_anomalie`),
   CONSTRAINT `aEteScannePar_ibfk_1`
    FOREIGN KEY (`id_anomalie`)
    REFERENCES `anomalies` (`id_anomalie`),
  CONSTRAINT `aEteScannePar_ibfk_2`
    FOREIGN KEY (`id_ronde`)
    REFERENCES `rondes` (`id_ronde`),
  CONSTRAINT `aEteScannePar_ibfk_3`
    FOREIGN KEY (`id_agent`)
    REFERENCES `agents` (`id_agent`),
  CONSTRAINT `aEteScannePar_ibfk_4`
    FOREIGN KEY (`id_pointeau`)
    REFERENCES `pointeaux` (`id_pointeau`));

CREATE TABLE `agents` (
  `id_agent` INTEGER NOT NULL,
  `nom` TEXT NULL DEFAULT NULL,
  `prenom` TEXT NULL DEFAULT NULL,
  `numbadge` TEXT NULL DEFAULT NULL,
  PRIMARY KEY (`id_agent`));

CREATE TABLE `anomalies` (
  `id_anomalie` INTEGER NOT NULL,
  `description` TEXT NULL DEFAULT NULL,
  PRIMARY KEY (`id_anomalie`));

CREATE TABLE `comporte` (
  `id_ronde` INTEGER NOT NULL,
  `id_pointeau` INTEGER NOT NULL,
  `ordre` INTEGER NULL DEFAULT NULL,
  `tempsmini` TEXT NULL DEFAULT NULL,
  `tempsmaxi` TEXT NULL DEFAULT NULL,
  PRIMARY KEY (`id_ronde`, `id_pointeau`),
  CONSTRAINT `comporte_ibfk_1`
    FOREIGN KEY (`id_pointeau`)
    REFERENCES `pointeaux` (`id_pointeau`),
  CONSTRAINT `comporte_ibfk_2`
    FOREIGN KEY (`id_ronde`)
    REFERENCES `rondes` (`id_ronde`));

CREATE TABLE `peutFaire` (
  `id_agent` INTEGER NOT NULL,
  `id_ronde` INTEGER NOT NULL,
  PRIMARY KEY (`id_agent`, `id_ronde`),
  CONSTRAINT `peutFaire_ibfk_1`
    FOREIGN KEY (`id_ronde`)
    REFERENCES `rondes` (`id_ronde`),
  CONSTRAINT `peutFaire_ibfk_2`
    FOREIGN KEY (`id_agent`)
    REFERENCES `agents` (`id_agent`));

CREATE TABLE `photos` (
  `id_photo` INTEGER NOT NULL,
  `chemin` TEXT NULL DEFAULT NULL,
  `id_anomalie` INTEGER NOT NULL,
  PRIMARY KEY (`id_photo`),
  CONSTRAINT `photos_ifk_1`
    FOREIGN KEY (`id_anomalie`)
    REFERENCES `anomalies` (`id_anomalie`));

CREATE TABLE `pointeaux` (
  `id_pointeau` INTEGER NOT NULL,
  `designation` TEXT NULL DEFAULT NULL,
  `tag_mifare` TEXT NULL DEFAULT NULL,
  `batiment` TEXT NULL DEFAULT NULL,
  `etage` TEXT NULL DEFAULT NULL,
  `emplacement` TEXT NULL DEFAULT NULL,
  PRIMARY KEY (`id_pointeau`));

CREATE TABLE `rondes` (
  `id_ronde` INTEGER NOT NULL,
  `nom` TEXT NULL DEFAULT NULL,
  PRIMARY KEY (`id_ronde`));
